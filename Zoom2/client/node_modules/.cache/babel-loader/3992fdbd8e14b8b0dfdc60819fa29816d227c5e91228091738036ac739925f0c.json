{"ast":null,"code":"var _jsxFileName = \"/Users/matty/Zoom2/Zoom2/client/src/components/VideoRoom.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useParams, useSearchParams, useNavigate } from 'react-router-dom';\nimport io from 'socket.io-client';\nimport styled from 'styled-components';\nimport { Mic, MicOff, Video, VideoOff, Monitor, MessageSquare, Phone, Users, Send } from 'lucide-react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Container = styled.div`\n  min-height: 100vh;\n  background: #1a1a1a;\n  display: flex;\n  flex-direction: column;\n`;\n_c = Container;\nconst Header = styled.div`\n  background: #2d2d2d;\n  padding: 15px 20px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  color: white;\n`;\n_c2 = Header;\nconst RoomInfo = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 10px;\n`;\n_c3 = RoomInfo;\nconst RoomId = styled.span`\n  font-weight: 600;\n  font-size: 1.1rem;\n`;\n_c4 = RoomId;\nconst MainContent = styled.div`\n  flex: 1;\n  display: flex;\n  position: relative;\n`;\n_c5 = MainContent;\nconst VideoGrid = styled.div`\n  flex: 1;\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n  gap: 10px;\n  padding: 20px;\n  align-content: start;\n`;\n_c6 = VideoGrid;\nconst VideoContainer = styled.div`\n  position: relative;\n  background: #333;\n  border-radius: 10px;\n  overflow: hidden;\n  aspect-ratio: 16/9;\n  min-height: 200px;\n`;\n_c7 = VideoContainer;\nconst StyledVideo = styled.video`\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n`;\n_c8 = StyledVideo;\nconst VideoLabel = styled.div`\n  position: absolute;\n  bottom: 10px;\n  left: 10px;\n  background: rgba(0, 0, 0, 0.7);\n  color: white;\n  padding: 5px 10px;\n  border-radius: 5px;\n  font-size: 0.9rem;\n`;\n_c9 = VideoLabel;\nconst ChatPanel = styled.div`\n  width: 350px;\n  background: #2d2d2d;\n  display: flex;\n  flex-direction: column;\n  border-left: 1px solid #444;\n`;\n_c0 = ChatPanel;\nconst ChatHeader = styled.div`\n  padding: 15px 20px;\n  border-bottom: 1px solid #444;\n  color: white;\n  font-weight: 600;\n`;\n_c1 = ChatHeader;\nconst ChatMessages = styled.div`\n  flex: 1;\n  padding: 15px;\n  overflow-y: auto;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n`;\n_c10 = ChatMessages;\nconst Message = styled.div`\n  background: ${props => props.isOwn ? '#667eea' : '#444'};\n  color: white;\n  padding: 10px 15px;\n  border-radius: 10px;\n  max-width: 80%;\n  align-self: ${props => props.isOwn ? 'flex-end' : 'flex-start'};\n  word-wrap: break-word;\n`;\n_c11 = Message;\nconst MessageSender = styled.div`\n  font-size: 0.8rem;\n  opacity: 0.7;\n  margin-bottom: 5px;\n`;\n_c12 = MessageSender;\nconst ChatInput = styled.div`\n  padding: 15px;\n  border-top: 1px solid #444;\n  display: flex;\n  gap: 10px;\n`;\n_c13 = ChatInput;\nconst MessageInput = styled.input`\n  flex: 1;\n  padding: 10px 15px;\n  border: 1px solid #555;\n  border-radius: 20px;\n  background: #333;\n  color: white;\n  font-size: 0.9rem;\n\n  &:focus {\n    outline: none;\n    border-color: #667eea;\n  }\n\n  &::placeholder {\n    color: #999;\n  }\n`;\n_c14 = MessageInput;\nconst SendButton = styled.button`\n  background: #667eea;\n  border: none;\n  border-radius: 50%;\n  width: 40px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  cursor: pointer;\n  transition: background 0.3s ease;\n\n  &:hover {\n    background: #5a6fd8;\n  }\n`;\n_c15 = SendButton;\nconst Controls = styled.div`\n  background: #2d2d2d;\n  padding: 20px;\n  display: flex;\n  justify-content: center;\n  gap: 15px;\n  border-top: 1px solid #444;\n`;\n_c16 = Controls;\nconst ControlButton = styled.button`\n  background: ${props => props.active ? '#667eea' : '#444'};\n  border: none;\n  border-radius: 50%;\n  width: 50px;\n  height: 50px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  cursor: pointer;\n  transition: all 0.3s ease;\n\n  &:hover {\n    background: ${props => props.active ? '#5a6fd8' : '#555'};\n  }\n\n  &.leave {\n    background: #dc3545;\n    \n    &:hover {\n      background: #c82333;\n    }\n  }\n`;\n_c17 = ControlButton;\nconst VideoRoom = () => {\n  _s();\n  const {\n    roomId\n  } = useParams();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n  const [socket, setSocket] = useState(null);\n  const [localStream, setLocalStream] = useState(null);\n  const [remoteStreams, setRemoteStreams] = useState(new Map());\n  const [isAudioMuted, setIsAudioMuted] = useState(false);\n  const [isVideoMuted, setIsVideoMuted] = useState(false);\n  const [isScreenSharing, setIsScreenSharing] = useState(false);\n  const [showChat, setShowChat] = useState(false);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [participants, setParticipants] = useState(1);\n  const localVideoRef = useRef(null);\n  const remoteVideoRefs = useRef(new Map());\n  const peerConnections = useRef(new Map());\n  const userName = searchParams.get('name') || 'Anonymous';\n  const [socketId, setSocketId] = useState(null);\n\n  // Initialize socket connection\n  useEffect(() => {\n    const socketUrl = process.env.NODE_ENV === 'production' ? window.location.origin : 'http://localhost:5001';\n    const newSocket = io(socketUrl);\n    setSocket(newSocket);\n\n    // Store socket ID when connected\n    newSocket.on('connect', () => {\n      setSocketId(newSocket.id);\n      console.log('Socket connected with ID:', newSocket.id);\n    });\n    return () => {\n      newSocket.close();\n    };\n  }, []);\n\n  // Initialize local media stream\n  useEffect(() => {\n    const initLocalStream = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: true,\n          audio: true\n        });\n        setLocalStream(stream);\n        if (localVideoRef.current) {\n          localVideoRef.current.srcObject = stream;\n        }\n      } catch (error) {\n        console.error('Error accessing media devices:', error);\n        alert('Unable to access camera and microphone. Please check permissions.');\n      }\n    };\n    initLocalStream();\n  }, []);\n\n  // Socket event handlers\n  useEffect(() => {\n    if (!socket) return;\n    const handleUserConnected = userId => {\n      console.log('User connected:', userId);\n      setParticipants(prev => prev + 1);\n      createPeerConnection(userId);\n      // Send offer to the new user\n      setTimeout(() => {\n        sendOffer(userId);\n      }, 1000); // Small delay to ensure peer connection is established\n    };\n    const handleUserDisconnected = userId => {\n      console.log('User disconnected:', userId);\n      setParticipants(prev => prev - 1);\n      if (peerConnections.current.has(userId)) {\n        peerConnections.current.get(userId).close();\n        peerConnections.current.delete(userId);\n      }\n      setRemoteStreams(prev => {\n        const newStreams = new Map(prev);\n        newStreams.delete(userId);\n        return newStreams;\n      });\n    };\n    const handleOffer = async data => {\n      console.log('Received offer from:', data.userId);\n      await handleOfferReceived(data);\n    };\n    const handleAnswer = async data => {\n      console.log('Received answer from:', data.userId);\n      await handleAnswerReceived(data);\n    };\n    const handleIceCandidate = async data => {\n      console.log('Received ICE candidate from:', data.userId);\n      await handleIceCandidateReceived(data);\n    };\n    const handleMessage = data => {\n      setMessages(prev => [...prev, data]);\n    };\n    const handleExistingUsers = existingUsers => {\n      console.log('Existing users:', existingUsers);\n      existingUsers.forEach(userId => {\n        if (userId !== userName) {\n          // Don't create connection to self\n          createPeerConnection(userId);\n          setTimeout(() => {\n            sendOffer(userId);\n          }, 1000);\n        }\n      });\n    };\n    socket.on('user-connected', handleUserConnected);\n    socket.on('user-disconnected', handleUserDisconnected);\n    socket.on('offer', handleOffer);\n    socket.on('answer', handleAnswer);\n    socket.on('ice-candidate', handleIceCandidate);\n    socket.on('receive-message', handleMessage);\n    socket.on('existing-users', handleExistingUsers);\n    return () => {\n      socket.off('user-connected', handleUserConnected);\n      socket.off('user-disconnected', handleUserDisconnected);\n      socket.off('offer', handleOffer);\n      socket.off('answer', handleAnswer);\n      socket.off('ice-candidate', handleIceCandidate);\n      socket.off('receive-message', handleMessage);\n      socket.off('existing-users', handleExistingUsers);\n    };\n  }, [socket, createPeerConnection, sendOffer, handleAnswerReceived, handleIceCandidateReceived, handleOfferReceived, userName]);\n\n  // Join room when socket is ready\n  useEffect(() => {\n    if (socket && roomId && socketId) {\n      const userId = `${userName}-${socketId}`;\n      console.log('Joining room with user ID:', userId);\n      socket.emit('join-room', roomId, userId);\n    }\n  }, [socket, roomId, userName, socketId]);\n\n  // Send offers to existing users when local stream is ready\n  useEffect(() => {\n    if (localStream && socket && roomId && socketId) {\n      // Get existing participants and send offers to them\n      socket.emit('get-existing-users', roomId);\n    }\n  }, [localStream, socket, roomId, socketId]);\n\n  // Create peer connection\n  const createPeerConnection = useCallback(userId => {\n    const peerConnection = new RTCPeerConnection({\n      iceServers: [{\n        urls: 'stun:stun.l.google.com:19302'\n      }, {\n        urls: 'stun:stun1.l.google.com:19302'\n      }]\n    });\n\n    // Add local stream tracks\n    if (localStream) {\n      localStream.getTracks().forEach(track => {\n        peerConnection.addTrack(track, localStream);\n      });\n    }\n\n    // Handle remote stream\n    peerConnection.ontrack = event => {\n      console.log('Received remote stream from:', userId);\n      const [remoteStream] = event.streams;\n      setRemoteStreams(prev => new Map(prev).set(userId, remoteStream));\n    };\n\n    // Handle ICE candidates\n    peerConnection.onicecandidate = event => {\n      if (event.candidate) {\n        socket.emit('ice-candidate', {\n          candidate: event.candidate,\n          roomId,\n          userId\n        });\n      }\n    };\n    peerConnections.current.set(userId, peerConnection);\n  }, [localStream, socket, roomId]);\n\n  // Handle offer received\n  const handleOfferReceived = useCallback(async data => {\n    const {\n      offer,\n      userId\n    } = data;\n    let peerConnection = peerConnections.current.get(userId);\n    if (!peerConnection) {\n      createPeerConnection(userId);\n      peerConnection = peerConnections.current.get(userId);\n    }\n    try {\n      await peerConnection.setRemoteDescription(new RTCSessionDescription(offer));\n      const answer = await peerConnection.createAnswer();\n      await peerConnection.setLocalDescription(answer);\n      socket.emit('answer', {\n        answer,\n        roomId,\n        userId\n      });\n    } catch (error) {\n      console.error('Error handling offer:', error);\n    }\n  }, [createPeerConnection, socket, roomId]);\n\n  // Handle answer received\n  const handleAnswerReceived = useCallback(async data => {\n    const {\n      answer,\n      userId\n    } = data;\n    const peerConnection = peerConnections.current.get(userId);\n    if (peerConnection) {\n      try {\n        await peerConnection.setRemoteDescription(new RTCSessionDescription(answer));\n      } catch (error) {\n        console.error('Error handling answer:', error);\n      }\n    }\n  }, []);\n\n  // Handle ICE candidate received\n  const handleIceCandidateReceived = useCallback(async data => {\n    const {\n      candidate,\n      userId\n    } = data;\n    const peerConnection = peerConnections.current.get(userId);\n    if (peerConnection) {\n      try {\n        await peerConnection.addIceCandidate(new RTCIceCandidate(candidate));\n      } catch (error) {\n        console.error('Error handling ICE candidate:', error);\n      }\n    }\n  }, []);\n\n  // Send offer to new user\n  const sendOffer = useCallback(async userId => {\n    const peerConnection = peerConnections.current.get(userId);\n    if (!peerConnection) return;\n    try {\n      const offer = await peerConnection.createOffer();\n      await peerConnection.setLocalDescription(offer);\n      socket.emit('offer', {\n        offer,\n        roomId,\n        userId\n      });\n    } catch (error) {\n      console.error('Error sending offer:', error);\n    }\n  }, [socket, roomId]);\n\n  // Toggle audio\n  const toggleAudio = () => {\n    if (localStream) {\n      const audioTrack = localStream.getAudioTracks()[0];\n      if (audioTrack) {\n        audioTrack.enabled = !audioTrack.enabled;\n        setIsAudioMuted(!audioTrack.enabled);\n      }\n    }\n  };\n\n  // Toggle video\n  const toggleVideo = () => {\n    if (localStream) {\n      const videoTrack = localStream.getVideoTracks()[0];\n      if (videoTrack) {\n        videoTrack.enabled = !videoTrack.enabled;\n        setIsVideoMuted(!videoTrack.enabled);\n      }\n    }\n  };\n\n  // Toggle screen sharing\n  const toggleScreenShare = async () => {\n    try {\n      if (!isScreenSharing) {\n        const screenStream = await navigator.mediaDevices.getDisplayMedia({\n          video: true,\n          audio: true\n        });\n\n        // Replace video track in all peer connections\n        const videoTrack = screenStream.getVideoTracks()[0];\n        peerConnections.current.forEach(peerConnection => {\n          const sender = peerConnection.getSenders().find(s => s.track && s.track.kind === 'video');\n          if (sender) {\n            sender.replaceTrack(videoTrack);\n          }\n        });\n\n        // Update local video\n        if (localVideoRef.current) {\n          localVideoRef.current.srcObject = screenStream;\n        }\n        setIsScreenSharing(true);\n\n        // Handle screen share end\n        videoTrack.onended = () => {\n          toggleScreenShare();\n        };\n      } else {\n        // Stop screen sharing and restore camera\n        if (localStream) {\n          const videoTrack = localStream.getVideoTracks()[0];\n          peerConnections.current.forEach(peerConnection => {\n            const sender = peerConnection.getSenders().find(s => s.track && s.track.kind === 'video');\n            if (sender) {\n              sender.replaceTrack(videoTrack);\n            }\n          });\n          if (localVideoRef.current) {\n            localVideoRef.current.srcObject = localStream;\n          }\n        }\n        setIsScreenSharing(false);\n      }\n    } catch (error) {\n      console.error('Error toggling screen share:', error);\n    }\n  };\n\n  // Send message\n  const sendMessage = () => {\n    if (newMessage.trim() && socket) {\n      const message = {\n        text: newMessage.trim(),\n        sender: userName,\n        timestamp: new Date().toISOString()\n      };\n      socket.emit('send-message', {\n        message,\n        roomId\n      });\n      setNewMessage('');\n    }\n  };\n\n  // Leave room\n  const leaveRoom = () => {\n    if (socket) {\n      socket.emit('leave-room', roomId, userName);\n    }\n\n    // Close all peer connections\n    peerConnections.current.forEach(peerConnection => {\n      peerConnection.close();\n    });\n\n    // Stop local stream\n    if (localStream) {\n      localStream.getTracks().forEach(track => track.stop());\n    }\n    navigate('/');\n  };\n\n  // Handle key press for message input\n  const handleKeyPress = e => {\n    if (e.key === 'Enter') {\n      sendMessage();\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [/*#__PURE__*/_jsxDEV(Header, {\n      children: /*#__PURE__*/_jsxDEV(RoomInfo, {\n        children: [/*#__PURE__*/_jsxDEV(Users, {\n          size: 20\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 591,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(RoomId, {\n          children: [\"Room: \", roomId]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 592,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"(\", participants, \" participants)\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 593,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 590,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 589,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(MainContent, {\n      children: [/*#__PURE__*/_jsxDEV(VideoGrid, {\n        children: [/*#__PURE__*/_jsxDEV(VideoContainer, {\n          children: [/*#__PURE__*/_jsxDEV(StyledVideo, {\n            ref: localVideoRef,\n            autoPlay: true,\n            muted: true,\n            playsInline: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 601,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(VideoLabel, {\n            children: [userName, \" (You)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 607,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 600,\n          columnNumber: 11\n        }, this), Array.from(remoteStreams.entries()).map(([userId, stream]) => /*#__PURE__*/_jsxDEV(VideoContainer, {\n          children: [/*#__PURE__*/_jsxDEV(StyledVideo, {\n            ref: ref => {\n              if (ref) {\n                ref.srcObject = stream;\n                remoteVideoRefs.current.set(userId, ref);\n              }\n            },\n            autoPlay: true,\n            playsInline: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 613,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(VideoLabel, {\n            children: userId\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 623,\n            columnNumber: 15\n          }, this)]\n        }, userId, true, {\n          fileName: _jsxFileName,\n          lineNumber: 612,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 598,\n        columnNumber: 9\n      }, this), showChat && /*#__PURE__*/_jsxDEV(ChatPanel, {\n        children: [/*#__PURE__*/_jsxDEV(ChatHeader, {\n          children: \"Chat\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 630,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(ChatMessages, {\n          children: messages.map((message, index) => /*#__PURE__*/_jsxDEV(Message, {\n            isOwn: message.sender === userName,\n            children: [/*#__PURE__*/_jsxDEV(MessageSender, {\n              children: message.sender\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 634,\n              columnNumber: 19\n            }, this), message.text]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 633,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 631,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(ChatInput, {\n          children: [/*#__PURE__*/_jsxDEV(MessageInput, {\n            type: \"text\",\n            placeholder: \"Type a message...\",\n            value: newMessage,\n            onChange: e => setNewMessage(e.target.value),\n            onKeyPress: handleKeyPress\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 640,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(SendButton, {\n            onClick: sendMessage,\n            children: /*#__PURE__*/_jsxDEV(Send, {\n              size: 16\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 648,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 647,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 639,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 629,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 597,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Controls, {\n      children: [/*#__PURE__*/_jsxDEV(ControlButton, {\n        onClick: toggleAudio,\n        active: !isAudioMuted,\n        title: isAudioMuted ? 'Unmute' : 'Mute',\n        children: isAudioMuted ? /*#__PURE__*/_jsxDEV(MicOff, {\n          size: 20\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 661,\n          columnNumber: 27\n        }, this) : /*#__PURE__*/_jsxDEV(Mic, {\n          size: 20\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 661,\n          columnNumber: 50\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 656,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ControlButton, {\n        onClick: toggleVideo,\n        active: !isVideoMuted,\n        title: isVideoMuted ? 'Turn on camera' : 'Turn off camera',\n        children: isVideoMuted ? /*#__PURE__*/_jsxDEV(VideoOff, {\n          size: 20\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 669,\n          columnNumber: 27\n        }, this) : /*#__PURE__*/_jsxDEV(Video, {\n          size: 20\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 669,\n          columnNumber: 52\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 664,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ControlButton, {\n        onClick: toggleScreenShare,\n        active: isScreenSharing,\n        title: isScreenSharing ? 'Stop sharing' : 'Share screen',\n        children: /*#__PURE__*/_jsxDEV(Monitor, {\n          size: 20\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 677,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 672,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ControlButton, {\n        onClick: () => setShowChat(!showChat),\n        active: showChat,\n        title: \"Toggle chat\",\n        children: /*#__PURE__*/_jsxDEV(MessageSquare, {\n          size: 20\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 685,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 680,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ControlButton, {\n        onClick: leaveRoom,\n        className: \"leave\",\n        title: \"Leave room\",\n        children: /*#__PURE__*/_jsxDEV(Phone, {\n          size: 20\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 693,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 688,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 655,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 588,\n    columnNumber: 5\n  }, this);\n};\n_s(VideoRoom, \"dkk5DW3dTb7MtEAjcGXk2Yw0ECQ=\", false, function () {\n  return [useParams, useSearchParams, useNavigate];\n});\n_c18 = VideoRoom;\nexport default VideoRoom;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c0, _c1, _c10, _c11, _c12, _c13, _c14, _c15, _c16, _c17, _c18;\n$RefreshReg$(_c, \"Container\");\n$RefreshReg$(_c2, \"Header\");\n$RefreshReg$(_c3, \"RoomInfo\");\n$RefreshReg$(_c4, \"RoomId\");\n$RefreshReg$(_c5, \"MainContent\");\n$RefreshReg$(_c6, \"VideoGrid\");\n$RefreshReg$(_c7, \"VideoContainer\");\n$RefreshReg$(_c8, \"StyledVideo\");\n$RefreshReg$(_c9, \"VideoLabel\");\n$RefreshReg$(_c0, \"ChatPanel\");\n$RefreshReg$(_c1, \"ChatHeader\");\n$RefreshReg$(_c10, \"ChatMessages\");\n$RefreshReg$(_c11, \"Message\");\n$RefreshReg$(_c12, \"MessageSender\");\n$RefreshReg$(_c13, \"ChatInput\");\n$RefreshReg$(_c14, \"MessageInput\");\n$RefreshReg$(_c15, \"SendButton\");\n$RefreshReg$(_c16, \"Controls\");\n$RefreshReg$(_c17, \"ControlButton\");\n$RefreshReg$(_c18, \"VideoRoom\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useCallback","useParams","useSearchParams","useNavigate","io","styled","Mic","MicOff","Video","VideoOff","Monitor","MessageSquare","Phone","Users","Send","jsxDEV","_jsxDEV","Container","div","_c","Header","_c2","RoomInfo","_c3","RoomId","span","_c4","MainContent","_c5","VideoGrid","_c6","VideoContainer","_c7","StyledVideo","video","_c8","VideoLabel","_c9","ChatPanel","_c0","ChatHeader","_c1","ChatMessages","_c10","Message","props","isOwn","_c11","MessageSender","_c12","ChatInput","_c13","MessageInput","input","_c14","SendButton","button","_c15","Controls","_c16","ControlButton","active","_c17","VideoRoom","_s","roomId","searchParams","navigate","socket","setSocket","localStream","setLocalStream","remoteStreams","setRemoteStreams","Map","isAudioMuted","setIsAudioMuted","isVideoMuted","setIsVideoMuted","isScreenSharing","setIsScreenSharing","showChat","setShowChat","messages","setMessages","newMessage","setNewMessage","participants","setParticipants","localVideoRef","remoteVideoRefs","peerConnections","userName","get","socketId","setSocketId","socketUrl","process","env","NODE_ENV","window","location","origin","newSocket","on","id","console","log","close","initLocalStream","stream","navigator","mediaDevices","getUserMedia","audio","current","srcObject","error","alert","handleUserConnected","userId","prev","createPeerConnection","setTimeout","sendOffer","handleUserDisconnected","has","delete","newStreams","handleOffer","data","handleOfferReceived","handleAnswer","handleAnswerReceived","handleIceCandidate","handleIceCandidateReceived","handleMessage","handleExistingUsers","existingUsers","forEach","off","emit","peerConnection","RTCPeerConnection","iceServers","urls","getTracks","track","addTrack","ontrack","event","remoteStream","streams","set","onicecandidate","candidate","offer","setRemoteDescription","RTCSessionDescription","answer","createAnswer","setLocalDescription","addIceCandidate","RTCIceCandidate","createOffer","toggleAudio","audioTrack","getAudioTracks","enabled","toggleVideo","videoTrack","getVideoTracks","toggleScreenShare","screenStream","getDisplayMedia","sender","getSenders","find","s","kind","replaceTrack","onended","sendMessage","trim","message","text","timestamp","Date","toISOString","leaveRoom","stop","handleKeyPress","e","key","children","size","fileName","_jsxFileName","lineNumber","columnNumber","ref","autoPlay","muted","playsInline","Array","from","entries","map","index","type","placeholder","value","onChange","target","onKeyPress","onClick","title","className","_c18","$RefreshReg$"],"sources":["/Users/matty/Zoom2/Zoom2/client/src/components/VideoRoom.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useParams, useSearchParams, useNavigate } from 'react-router-dom';\nimport io from 'socket.io-client';\nimport styled from 'styled-components';\nimport { \n  Mic, \n  MicOff, \n  Video, \n  VideoOff, \n  Monitor, \n  MessageSquare, \n  Phone, \n  Users,\n  Send\n} from 'lucide-react';\n\nconst Container = styled.div`\n  min-height: 100vh;\n  background: #1a1a1a;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst Header = styled.div`\n  background: #2d2d2d;\n  padding: 15px 20px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  color: white;\n`;\n\nconst RoomInfo = styled.div`\n  display: flex;\n  align-items: center;\n  gap: 10px;\n`;\n\nconst RoomId = styled.span`\n  font-weight: 600;\n  font-size: 1.1rem;\n`;\n\nconst MainContent = styled.div`\n  flex: 1;\n  display: flex;\n  position: relative;\n`;\n\nconst VideoGrid = styled.div`\n  flex: 1;\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));\n  gap: 10px;\n  padding: 20px;\n  align-content: start;\n`;\n\nconst VideoContainer = styled.div`\n  position: relative;\n  background: #333;\n  border-radius: 10px;\n  overflow: hidden;\n  aspect-ratio: 16/9;\n  min-height: 200px;\n`;\n\nconst StyledVideo = styled.video`\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n`;\n\nconst VideoLabel = styled.div`\n  position: absolute;\n  bottom: 10px;\n  left: 10px;\n  background: rgba(0, 0, 0, 0.7);\n  color: white;\n  padding: 5px 10px;\n  border-radius: 5px;\n  font-size: 0.9rem;\n`;\n\nconst ChatPanel = styled.div`\n  width: 350px;\n  background: #2d2d2d;\n  display: flex;\n  flex-direction: column;\n  border-left: 1px solid #444;\n`;\n\nconst ChatHeader = styled.div`\n  padding: 15px 20px;\n  border-bottom: 1px solid #444;\n  color: white;\n  font-weight: 600;\n`;\n\nconst ChatMessages = styled.div`\n  flex: 1;\n  padding: 15px;\n  overflow-y: auto;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n`;\n\nconst Message = styled.div`\n  background: ${props => props.isOwn ? '#667eea' : '#444'};\n  color: white;\n  padding: 10px 15px;\n  border-radius: 10px;\n  max-width: 80%;\n  align-self: ${props => props.isOwn ? 'flex-end' : 'flex-start'};\n  word-wrap: break-word;\n`;\n\nconst MessageSender = styled.div`\n  font-size: 0.8rem;\n  opacity: 0.7;\n  margin-bottom: 5px;\n`;\n\nconst ChatInput = styled.div`\n  padding: 15px;\n  border-top: 1px solid #444;\n  display: flex;\n  gap: 10px;\n`;\n\nconst MessageInput = styled.input`\n  flex: 1;\n  padding: 10px 15px;\n  border: 1px solid #555;\n  border-radius: 20px;\n  background: #333;\n  color: white;\n  font-size: 0.9rem;\n\n  &:focus {\n    outline: none;\n    border-color: #667eea;\n  }\n\n  &::placeholder {\n    color: #999;\n  }\n`;\n\nconst SendButton = styled.button`\n  background: #667eea;\n  border: none;\n  border-radius: 50%;\n  width: 40px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  cursor: pointer;\n  transition: background 0.3s ease;\n\n  &:hover {\n    background: #5a6fd8;\n  }\n`;\n\nconst Controls = styled.div`\n  background: #2d2d2d;\n  padding: 20px;\n  display: flex;\n  justify-content: center;\n  gap: 15px;\n  border-top: 1px solid #444;\n`;\n\nconst ControlButton = styled.button`\n  background: ${props => props.active ? '#667eea' : '#444'};\n  border: none;\n  border-radius: 50%;\n  width: 50px;\n  height: 50px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  cursor: pointer;\n  transition: all 0.3s ease;\n\n  &:hover {\n    background: ${props => props.active ? '#5a6fd8' : '#555'};\n  }\n\n  &.leave {\n    background: #dc3545;\n    \n    &:hover {\n      background: #c82333;\n    }\n  }\n`;\n\nconst VideoRoom = () => {\n  const { roomId } = useParams();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n  \n  const [socket, setSocket] = useState(null);\n  const [localStream, setLocalStream] = useState(null);\n  const [remoteStreams, setRemoteStreams] = useState(new Map());\n  const [isAudioMuted, setIsAudioMuted] = useState(false);\n  const [isVideoMuted, setIsVideoMuted] = useState(false);\n  const [isScreenSharing, setIsScreenSharing] = useState(false);\n  const [showChat, setShowChat] = useState(false);\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState('');\n  const [participants, setParticipants] = useState(1);\n\n  const localVideoRef = useRef(null);\n  const remoteVideoRefs = useRef(new Map());\n  const peerConnections = useRef(new Map());\n  const userName = searchParams.get('name') || 'Anonymous';\n  const [socketId, setSocketId] = useState(null);\n\n  // Initialize socket connection\n  useEffect(() => {\n    const socketUrl = process.env.NODE_ENV === 'production' \n      ? window.location.origin \n      : 'http://localhost:5001';\n    const newSocket = io(socketUrl);\n    setSocket(newSocket);\n    \n    // Store socket ID when connected\n    newSocket.on('connect', () => {\n      setSocketId(newSocket.id);\n      console.log('Socket connected with ID:', newSocket.id);\n    });\n\n    return () => {\n      newSocket.close();\n    };\n  }, []);\n\n  // Initialize local media stream\n  useEffect(() => {\n    const initLocalStream = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: true,\n          audio: true\n        });\n        setLocalStream(stream);\n        if (localVideoRef.current) {\n          localVideoRef.current.srcObject = stream;\n        }\n      } catch (error) {\n        console.error('Error accessing media devices:', error);\n        alert('Unable to access camera and microphone. Please check permissions.');\n      }\n    };\n\n    initLocalStream();\n  }, []);\n\n  // Socket event handlers\n  useEffect(() => {\n    if (!socket) return;\n\n    const handleUserConnected = (userId) => {\n      console.log('User connected:', userId);\n      setParticipants(prev => prev + 1);\n      createPeerConnection(userId);\n      // Send offer to the new user\n      setTimeout(() => {\n        sendOffer(userId);\n      }, 1000); // Small delay to ensure peer connection is established\n    };\n\n    const handleUserDisconnected = (userId) => {\n      console.log('User disconnected:', userId);\n      setParticipants(prev => prev - 1);\n      if (peerConnections.current.has(userId)) {\n        peerConnections.current.get(userId).close();\n        peerConnections.current.delete(userId);\n      }\n      setRemoteStreams(prev => {\n        const newStreams = new Map(prev);\n        newStreams.delete(userId);\n        return newStreams;\n      });\n    };\n\n    const handleOffer = async (data) => {\n      console.log('Received offer from:', data.userId);\n      await handleOfferReceived(data);\n    };\n\n    const handleAnswer = async (data) => {\n      console.log('Received answer from:', data.userId);\n      await handleAnswerReceived(data);\n    };\n\n    const handleIceCandidate = async (data) => {\n      console.log('Received ICE candidate from:', data.userId);\n      await handleIceCandidateReceived(data);\n    };\n\n    const handleMessage = (data) => {\n      setMessages(prev => [...prev, data]);\n    };\n\n    const handleExistingUsers = (existingUsers) => {\n      console.log('Existing users:', existingUsers);\n      existingUsers.forEach(userId => {\n        if (userId !== userName) { // Don't create connection to self\n          createPeerConnection(userId);\n          setTimeout(() => {\n            sendOffer(userId);\n          }, 1000);\n        }\n      });\n    };\n\n    socket.on('user-connected', handleUserConnected);\n    socket.on('user-disconnected', handleUserDisconnected);\n    socket.on('offer', handleOffer);\n    socket.on('answer', handleAnswer);\n    socket.on('ice-candidate', handleIceCandidate);\n    socket.on('receive-message', handleMessage);\n    socket.on('existing-users', handleExistingUsers);\n\n    return () => {\n      socket.off('user-connected', handleUserConnected);\n      socket.off('user-disconnected', handleUserDisconnected);\n      socket.off('offer', handleOffer);\n      socket.off('answer', handleAnswer);\n      socket.off('ice-candidate', handleIceCandidate);\n      socket.off('receive-message', handleMessage);\n      socket.off('existing-users', handleExistingUsers);\n    };\n  }, [socket, createPeerConnection, sendOffer, handleAnswerReceived, handleIceCandidateReceived, handleOfferReceived, userName]);\n\n  // Join room when socket is ready\n  useEffect(() => {\n    if (socket && roomId && socketId) {\n      const userId = `${userName}-${socketId}`;\n      console.log('Joining room with user ID:', userId);\n      socket.emit('join-room', roomId, userId);\n    }\n  }, [socket, roomId, userName, socketId]);\n\n  // Send offers to existing users when local stream is ready\n  useEffect(() => {\n    if (localStream && socket && roomId && socketId) {\n      // Get existing participants and send offers to them\n      socket.emit('get-existing-users', roomId);\n    }\n  }, [localStream, socket, roomId, socketId]);\n\n  // Create peer connection\n  const createPeerConnection = useCallback((userId) => {\n    const peerConnection = new RTCPeerConnection({\n      iceServers: [\n        { urls: 'stun:stun.l.google.com:19302' },\n        { urls: 'stun:stun1.l.google.com:19302' }\n      ]\n    });\n\n    // Add local stream tracks\n    if (localStream) {\n      localStream.getTracks().forEach(track => {\n        peerConnection.addTrack(track, localStream);\n      });\n    }\n\n    // Handle remote stream\n    peerConnection.ontrack = (event) => {\n      console.log('Received remote stream from:', userId);\n      const [remoteStream] = event.streams;\n      setRemoteStreams(prev => new Map(prev).set(userId, remoteStream));\n    };\n\n    // Handle ICE candidates\n    peerConnection.onicecandidate = (event) => {\n      if (event.candidate) {\n        socket.emit('ice-candidate', {\n          candidate: event.candidate,\n          roomId,\n          userId\n        });\n      }\n    };\n\n    peerConnections.current.set(userId, peerConnection);\n  }, [localStream, socket, roomId]);\n\n  // Handle offer received\n  const handleOfferReceived = useCallback(async (data) => {\n    const { offer, userId } = data;\n    let peerConnection = peerConnections.current.get(userId);\n    \n    if (!peerConnection) {\n      createPeerConnection(userId);\n      peerConnection = peerConnections.current.get(userId);\n    }\n\n    try {\n      await peerConnection.setRemoteDescription(new RTCSessionDescription(offer));\n      const answer = await peerConnection.createAnswer();\n      await peerConnection.setLocalDescription(answer);\n      \n      socket.emit('answer', {\n        answer,\n        roomId,\n        userId\n      });\n    } catch (error) {\n      console.error('Error handling offer:', error);\n    }\n  }, [createPeerConnection, socket, roomId]);\n\n  // Handle answer received\n  const handleAnswerReceived = useCallback(async (data) => {\n    const { answer, userId } = data;\n    const peerConnection = peerConnections.current.get(userId);\n    \n    if (peerConnection) {\n      try {\n        await peerConnection.setRemoteDescription(new RTCSessionDescription(answer));\n      } catch (error) {\n        console.error('Error handling answer:', error);\n      }\n    }\n  }, []);\n\n  // Handle ICE candidate received\n  const handleIceCandidateReceived = useCallback(async (data) => {\n    const { candidate, userId } = data;\n    const peerConnection = peerConnections.current.get(userId);\n    \n    if (peerConnection) {\n      try {\n        await peerConnection.addIceCandidate(new RTCIceCandidate(candidate));\n      } catch (error) {\n        console.error('Error handling ICE candidate:', error);\n      }\n    }\n  }, []);\n\n  // Send offer to new user\n  const sendOffer = useCallback(async (userId) => {\n    const peerConnection = peerConnections.current.get(userId);\n    if (!peerConnection) return;\n\n    try {\n      const offer = await peerConnection.createOffer();\n      await peerConnection.setLocalDescription(offer);\n      \n      socket.emit('offer', {\n        offer,\n        roomId,\n        userId\n      });\n    } catch (error) {\n      console.error('Error sending offer:', error);\n    }\n  }, [socket, roomId]);\n\n  // Toggle audio\n  const toggleAudio = () => {\n    if (localStream) {\n      const audioTrack = localStream.getAudioTracks()[0];\n      if (audioTrack) {\n        audioTrack.enabled = !audioTrack.enabled;\n        setIsAudioMuted(!audioTrack.enabled);\n      }\n    }\n  };\n\n  // Toggle video\n  const toggleVideo = () => {\n    if (localStream) {\n      const videoTrack = localStream.getVideoTracks()[0];\n      if (videoTrack) {\n        videoTrack.enabled = !videoTrack.enabled;\n        setIsVideoMuted(!videoTrack.enabled);\n      }\n    }\n  };\n\n  // Toggle screen sharing\n  const toggleScreenShare = async () => {\n    try {\n      if (!isScreenSharing) {\n        const screenStream = await navigator.mediaDevices.getDisplayMedia({\n          video: true,\n          audio: true\n        });\n        \n        // Replace video track in all peer connections\n        const videoTrack = screenStream.getVideoTracks()[0];\n        peerConnections.current.forEach(peerConnection => {\n          const sender = peerConnection.getSenders().find(s => \n            s.track && s.track.kind === 'video'\n          );\n          if (sender) {\n            sender.replaceTrack(videoTrack);\n          }\n        });\n\n        // Update local video\n        if (localVideoRef.current) {\n          localVideoRef.current.srcObject = screenStream;\n        }\n\n        setIsScreenSharing(true);\n\n        // Handle screen share end\n        videoTrack.onended = () => {\n          toggleScreenShare();\n        };\n      } else {\n        // Stop screen sharing and restore camera\n        if (localStream) {\n          const videoTrack = localStream.getVideoTracks()[0];\n          peerConnections.current.forEach(peerConnection => {\n            const sender = peerConnection.getSenders().find(s => \n              s.track && s.track.kind === 'video'\n            );\n            if (sender) {\n              sender.replaceTrack(videoTrack);\n            }\n          });\n\n          if (localVideoRef.current) {\n            localVideoRef.current.srcObject = localStream;\n          }\n        }\n        setIsScreenSharing(false);\n      }\n    } catch (error) {\n      console.error('Error toggling screen share:', error);\n    }\n  };\n\n  // Send message\n  const sendMessage = () => {\n    if (newMessage.trim() && socket) {\n      const message = {\n        text: newMessage.trim(),\n        sender: userName,\n        timestamp: new Date().toISOString()\n      };\n      \n      socket.emit('send-message', { message, roomId });\n      setNewMessage('');\n    }\n  };\n\n  // Leave room\n  const leaveRoom = () => {\n    if (socket) {\n      socket.emit('leave-room', roomId, userName);\n    }\n    \n    // Close all peer connections\n    peerConnections.current.forEach(peerConnection => {\n      peerConnection.close();\n    });\n    \n    // Stop local stream\n    if (localStream) {\n      localStream.getTracks().forEach(track => track.stop());\n    }\n    \n    navigate('/');\n  };\n\n  // Handle key press for message input\n  const handleKeyPress = (e) => {\n    if (e.key === 'Enter') {\n      sendMessage();\n    }\n  };\n\n  return (\n    <Container>\n      <Header>\n        <RoomInfo>\n          <Users size={20} />\n          <RoomId>Room: {roomId}</RoomId>\n          <span>({participants} participants)</span>\n        </RoomInfo>\n      </Header>\n\n      <MainContent>\n        <VideoGrid>\n          {/* Local video */}\n          <VideoContainer>\n            <StyledVideo\n              ref={localVideoRef}\n              autoPlay\n              muted\n              playsInline\n            />\n            <VideoLabel>{userName} (You)</VideoLabel>\n          </VideoContainer>\n\n          {/* Remote videos */}\n          {Array.from(remoteStreams.entries()).map(([userId, stream]) => (\n            <VideoContainer key={userId}>\n              <StyledVideo\n                ref={ref => {\n                  if (ref) {\n                    ref.srcObject = stream;\n                    remoteVideoRefs.current.set(userId, ref);\n                  }\n                }}\n                autoPlay\n                playsInline\n              />\n              <VideoLabel>{userId}</VideoLabel>\n            </VideoContainer>\n          ))}\n        </VideoGrid>\n\n        {showChat && (\n          <ChatPanel>\n            <ChatHeader>Chat</ChatHeader>\n            <ChatMessages>\n              {messages.map((message, index) => (\n                <Message key={index} isOwn={message.sender === userName}>\n                  <MessageSender>{message.sender}</MessageSender>\n                  {message.text}\n                </Message>\n              ))}\n            </ChatMessages>\n            <ChatInput>\n              <MessageInput\n                type=\"text\"\n                placeholder=\"Type a message...\"\n                value={newMessage}\n                onChange={(e) => setNewMessage(e.target.value)}\n                onKeyPress={handleKeyPress}\n              />\n              <SendButton onClick={sendMessage}>\n                <Send size={16} />\n              </SendButton>\n            </ChatInput>\n          </ChatPanel>\n        )}\n      </MainContent>\n\n      <Controls>\n        <ControlButton\n          onClick={toggleAudio}\n          active={!isAudioMuted}\n          title={isAudioMuted ? 'Unmute' : 'Mute'}\n        >\n          {isAudioMuted ? <MicOff size={20} /> : <Mic size={20} />}\n        </ControlButton>\n\n        <ControlButton\n          onClick={toggleVideo}\n          active={!isVideoMuted}\n          title={isVideoMuted ? 'Turn on camera' : 'Turn off camera'}\n        >\n          {isVideoMuted ? <VideoOff size={20} /> : <Video size={20} />}\n        </ControlButton>\n\n        <ControlButton\n          onClick={toggleScreenShare}\n          active={isScreenSharing}\n          title={isScreenSharing ? 'Stop sharing' : 'Share screen'}\n        >\n          <Monitor size={20} />\n        </ControlButton>\n\n        <ControlButton\n          onClick={() => setShowChat(!showChat)}\n          active={showChat}\n          title=\"Toggle chat\"\n        >\n          <MessageSquare size={20} />\n        </ControlButton>\n\n        <ControlButton\n          onClick={leaveRoom}\n          className=\"leave\"\n          title=\"Leave room\"\n        >\n          <Phone size={20} />\n        </ControlButton>\n      </Controls>\n    </Container>\n  );\n};\n\nexport default VideoRoom;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}